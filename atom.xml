<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Enoch2090</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://enoch2090.github.io/"/>
  <updated>2021-03-23T17:29:31.206Z</updated>
  <id>https://enoch2090.github.io/</id>
  
  <author>
    <name>Phillip Gu</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>论文笔记：DDPG算法结构</title>
    <link href="https://enoch2090.github.io/2021/03/24/notes/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%EF%BC%9ADDPG%E7%AE%97%E6%B3%95%E7%BB%93%E6%9E%84/"/>
    <id>https://enoch2090.github.io/2021/03/24/notes/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0%EF%BC%9ADDPG%E7%AE%97%E6%B3%95%E7%BB%93%E6%9E%84/</id>
    <published>2021-03-23T16:00:00.000Z</published>
    <updated>2021-03-23T17:29:31.206Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>——他妈的，Hexo的公式渲染没配置好，全乱了。在修了在修了……</p></blockquote><p>实验室最近有个项目可能要用上一些强化学习和GNN相关的东西，只好疯狂看论文了。</p><p>这篇文章是DeepMind开发的面向连续控制的off policy算法，算是deterministic policy，据说效果不错。</p><p>论文地址：<a href="https://arxiv.org/abs/1509.02971" target="_blank" rel="noopener">Continuous control with deep reinforcement learning</a></p><ul><li><p>DQN：Q-function（状态价值函数）</p><ul><li>输入→状态，输出→动作空间的预期奖励</li><li>输入→状态、动作对，输出→这个动作的预期奖励</li><li>问题：只能应用于动作空间离散化的问题，否则Q函数计算量会极大。</li></ul></li><li><p>DDPG提出的解决方案：</p><ul><li><p>使用actor-critic双网络。算上训练过程，实际上共有四个网络：</p><ul><li>Actor current network，负责策略网络参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的更新，并且根据环境给出动作。</li><li>Actor target network，参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\theta^{ \prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>定期从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>复制。从replay buffer里采样的状态生成对应的动作。</li><li>Critic current network，负责价值网络参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>的迭代更新，并且给出当前的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q ( S , A , w )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>。</li><li>Critic target network，参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">w^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>定期从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>复制，计算目标<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q ( S , A , w )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li><li>target-current的机制是为了防止参数爆炸，将两个网络固定作为目标进行训练，然后定期复制训练中网络的参数（但是DDPG中不是直接复制，是用软更新）到目标网络上。</li></ul></li><li><p>损失函数：DDPG的策略是确定性的，所以不需要对动作空间作积分来取期望。对于Actor网络，原文定义的损失梯度是</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><msub><mrow><msub><mrow><msub><mi mathvariant="normal">∇</mi><msup><mi>θ</mi><mi>μ</mi></msup></msub><mi>μ</mi><mo fence="true">∣</mo></mrow><msub><mi>s</mi><mi>i</mi></msub></msub><mo>≈</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>i</mi></msub><msub><mi mathvariant="normal">∇</mi><mi>a</mi></msub><mi>Q</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>∣</mo><mi>w</mi><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mrow><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>a</mi><mo>=</mo><mi>μ</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow></msub><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>μ</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo>∣</mo><mi>θ</mi><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><msub><mi>s</mi><mi>i</mi></msub></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left. \left. \left. \nabla _ { \theta ^ { \mu } } \mu \right| _ { s _ { i } } \approx \frac { 1 } { N } \sum _ { i } \nabla _ { a } Q \left( s , a \mid w \right) \right| _ { s = s _ { i } , a = \mu \left( s _ { i } \right) } \nabla _ { \theta  } \mu \left( s \mid \theta  \right) \right| _ { s _ { i } }(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9678em;vertical-align:-0.7998149999999998em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016920000000000268em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.39979999999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.86199em;"><span style="top:-2.2559899999999997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.86199em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000999999999993em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.07550000000000012em;"><span style="top:-2.2505em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">a</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">μ</span><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6244999999999998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.167985em;"><span style="top:-1.955985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.561985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.167985em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6500149999999999em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.39832299999999987em;"><span style="top:-2.0002850000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7998149999999998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>对于Critic网络，用的是均方差损失</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>i</mi></msub><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>Q</mi><msup><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>∣</mo><msup><mi>θ</mi><mi>Q</mi></msup><mo fence="true">)</mo></mrow><mn>2</mn></msup><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = \frac { 1 } { N } \sum _ { i } \left( y _ { i } - Q \left( s _ { i } , a _ { i } \mid \theta ^ { Q } \right) ^ { 2 } \right)(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.054008em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>，其中</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>+</mo><mi>γ</mi><msup><mi>Q</mi><mo mathvariant="normal">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msup><mi>μ</mi><mo mathvariant="normal">′</mo></msup><mrow><mo fence="true">(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msup><mi>θ</mi><msup><mi>μ</mi><mo mathvariant="normal">′</mo></msup></msup><mo fence="true">)</mo></mrow><mo>∣</mo><msup><mi>θ</mi><msup><mi>Q</mi><mo mathvariant="normal">′</mo></msup></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">y _ { i } = r _ { i } + \gamma Q ^ { \prime } \left( s _ { i + 1 } , \mu ^ { \prime } \left( s _ { i + 1 } \mid \theta ^ { \mu ^ { \prime } } \right) \mid \theta ^ { Q ^ { \prime } } \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></p><p>是用从replay buffer采样的一组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left( s _ { i } , a _ { i } , r _ { i } , s _ { i + 1 } \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>算出来的。</p></li></ul></li><li><p>DDPG使用的特殊机制</p><ul><li><strong>类似DQN的Replay Buffer机制</strong>：用一个队列作为缓存，设定固定大小，维护<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left( s _ { t } , a _ { t } , r _ { t } , s _ { t + 1 } \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>。每次从这个队列里采样一个mini-batch进行训练。</li><li><strong>Soft target update软更新</strong>：不直接把更新后的权重赋值到网络里，而是创建actor和critic的拷贝，用拷贝计算目标进行训练，训练后的权重用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup><mo>←</mo><mi>τ</mi><mi>θ</mi><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>τ</mi><mo stretchy="false">)</mo><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\theta ^ { \prime } \leftarrow \tau \theta + ( 1 - \tau )\theta^{ \prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的方法（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi><mo>≪</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\tau \ll 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>）更新回去。</li><li><strong>随机化探索策略</strong>：通过用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="script">N</mi></mrow><annotation encoding="application/x-tex">A = \pi _ { \theta } ( S ) + \mathcal { N }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span></span></span>取代原本的动作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>。<ul><li>原文中用奥恩斯坦-乌伦贝克过程过程生成噪声<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">N</mi></mrow><annotation encoding="application/x-tex">\mathcal { N }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span></span></span>。OU过程在时序上具备很好的相关性，可以使agent很好的探索具备动量属性的环境，表达式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>θ</mi><mrow><mo fence="true">(</mo><mi>μ</mi><mo>−</mo><msub><mi>x</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><mi>W</mi></mrow><annotation encoding="application/x-tex">d x _ { t } = \theta \left( \mu - x _ { t } \right) d t + \sigma d W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是我们使用的变量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span>是这个变量的均值，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>表示维纳过程（一维下的概率密度函数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><msub><mi>W</mi><mi>t</mi></msub></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>π</mi><mi>t</mi></mrow></msqrt></mfrac><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f _ { W _ { t } } ( x ) = \frac { 1 } { \sqrt { 2 \pi t } } e ^ { - x ^ { 2 } / 2 t }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.5249199999999998em;vertical-align:-0.5379999999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.5510085em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.912845em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mord mathdefault mtight">t</span></span></span><span style="top:-2.872845em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12715500000000002em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5379999999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span></span>，数学期望为0，方差为t），<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>是维纳过程（其实就是布朗运动）带来的噪声的权重。</li><li>这个方法在惯性系统上（例如Pendulum）会提升探索效率，在我们之后对聚类做实现的时候不一定要用这个方法，因为聚类的更新不是典型的带惯性系统。</li></ul></li></ul></li><li><p>完整的算法过程：</p><p><strong>输入：</strong></p><ul><li>四个初始化的网络，分别使用参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo separator="true">,</mo><mtext>  </mtext><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><mtext>  </mtext><mi>w</mi><mo separator="true">,</mo><mtext>  </mtext><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\theta,\;\theta^{\prime},\;w,\;w^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></li><li>衰减因子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span></li><li>软更新系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span></span></span></span></li><li>从Replay Buffer采样的批量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></li><li>最大迭代次数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></li><li>Episode的数量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li><li>两个网络的更新频率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></li></ul><p><strong>输出：</strong></p><ul><li>训练完成的Actor和Critic网络，分别使用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>。</li></ul><p><strong>过程：</strong></p><ol><li>初始化四个网络和Replay Buffer <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></li><li>for i = 1, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> do<ol><li>初始化一个随机过程<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">N</mi></mrow><annotation encoding="application/x-tex">\mathcal{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span></span></span>，获取一个随机的初始状态<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>for t = 1, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> do<ol><li>使用当前的Actor生成一个动作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>μ</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>∣</mo><mi>θ</mi><mtext> </mtext><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi mathvariant="script">N</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t =\mu \left( s _ { t } \mid \theta \ \right) + \mathcal { N } _ { t }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace"> </span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>执行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，从环境获取<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left( s _ { t } , a _ { t } , r _ { t } , s _ { t + 1 } \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>放入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></li><li>从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>里采样大小为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的minibatch，分别计算对应的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，然后用这些值去计算Loss(2)，更新Critic current</li><li>用损失梯度(1)更新Actor current</li><li>用软更新方法更新3和4中得到的参数到Actor target和Critic target中</li></ol></li></ol></li></ol></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;——他妈的，Hexo的公式渲染没配置好，全乱了。在修了在修了……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;实验室最近有个项目可能要用上一些强化学习和GNN相关的东西，只好疯狂看论文了。&lt;/p&gt;
&lt;p&gt;这篇文章是DeepMind开发的面向连续控制的
      
    
    </summary>
    
    
    
      <category term="ReinforcementLearning" scheme="https://enoch2090.github.io/tags/ReinforcementLearning/"/>
    
      <category term="DeepLearning" scheme="https://enoch2090.github.io/tags/DeepLearning/"/>
    
  </entry>
  
  <entry>
    <title>北冰洋上的一年</title>
    <link href="https://enoch2090.github.io/2021/03/17/culture/%E5%8C%97%E5%86%B0%E6%B4%8B%E4%B8%8A%E7%9A%84%E4%B8%80%E5%B9%B4/"/>
    <id>https://enoch2090.github.io/2021/03/17/culture/%E5%8C%97%E5%86%B0%E6%B4%8B%E4%B8%8A%E7%9A%84%E4%B8%80%E5%B9%B4/</id>
    <published>2021-03-16T16:00:00.000Z</published>
    <updated>2021-03-17T14:29:26.266Z</updated>
    
    <content type="html"><![CDATA[<p> <style><br>    p{padding:0px; margin:0px;display: inline;}</style></p><p>「需要知道的是，被套上总有个开口。」<br>被子因此都有极性，<br>床靠船舱的一侧更为安全——<br>向右侧睡，背对墙壁。你<br>好好想想，该怎样去超越一块<br>床板：</p><p style="color:#115599">去承载血与肉以外的幻想，在空无的下坠中提供唯一的缓冲。让梦境切割极光、浮冰与海洋，在它与现实的交界提供如一的虚假。</p><p>站起来。抵抗你<br>软弱蜷曲的肢体，船既不容移动，<br>也不能沉没。凝固的恐惧穿透木板，刺破<br>棉布的魂灵。你终将理解，<br>为什么这样的冬天无法逃离静止：</p><p style="color:#115599">被凝聚态的熵裹挟，在每年第一缕晨光边境徘徊。应该让所有探路者都看看那块铭牌，我们的船并非核动力。冰脊早已碎裂发绿，沉默的龙骨重见天日。</p><p>躺回去吧，梦醒时分<br>被子的极性或许调换</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt; &lt;style&gt;&lt;br&gt;    p{padding:0px; margin:0px;display: inline;}
&lt;/style&gt;&lt;/p&gt;
&lt;p&gt;「需要知道的是，被套上总有个开口。」&lt;br&gt;
被子因此都有极性，&lt;br&gt;
床靠船舱的一侧更为安全——&lt;br&gt;
向右侧睡，背
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>修改服务器的Message of The Day</title>
    <link href="https://enoch2090.github.io/2021/01/23/tech/%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84Message%20of%20The%20Day/"/>
    <id>https://enoch2090.github.io/2021/01/23/tech/%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84Message%20of%20The%20Day/</id>
    <published>2021-01-22T16:00:00.000Z</published>
    <updated>2021-01-26T07:02:09.407Z</updated>
    
    <content type="html"><![CDATA[<p>之前搞了个脚本，可以自动把训练进度更新到Notion上。但是那个项目的页面不是所有人都顾着去看，加上实验室里同时进行的项目有好几个，有一台服务器上可能会跑各种训练，之间难免起冲突。</p><p>为了防止误操作，我把那台服务器的motd(Message of the Day)更新了一下。方法如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install update-motd</span><br><span class="line">sudo chmod -x /etc/update-motd.d/*</span><br></pre></td></tr></table></figure><p>这一步安装<code>update-motd</code>这个包并且禁用了默认的所有<code>motd</code>。然后</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/update-motd.d/graphic-card-stats</span><br></pre></td></tr></table></figure><p>新建一个文件，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">! /bin/sh</span></span><br><span class="line">neofetch</span><br><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure><p>这里面还调用了一下<code>neofetch</code>命令，安装方法见<a href="https://github.com/dylanaraps" target="_blank" rel="noopener">dylanbaraps</a>/<a href="https://github.com/dylanaraps/neofetch" target="_blank" rel="noopener">neofetch</a>。保存退出，<code>exit</code>退出ssh连接，重新登录即可：</p><p><img src="/2021/01/23/tech/%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84Message%20of%20The%20Day/updateMotd_.png" alt="updateMotd" style="zoom: 67%;"></p><p>Motd能不能算是UNIX系统的精髓？</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;之前搞了个脚本，可以自动把训练进度更新到Notion上。但是那个项目的页面不是所有人都顾着去看，加上实验室里同时进行的项目有好几个，有一台服务器上可能会跑各种训练，之间难免起冲突。&lt;/p&gt;
&lt;p&gt;为了防止误操作，我把那台服务器的motd(Message of the Day
      
    
    </summary>
    
    
    
      <category term="Linux" scheme="https://enoch2090.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>把YOLO标注文件转换为COCO格式</title>
    <link href="https://enoch2090.github.io/2021/01/06/tech/%E6%8A%8AYOLO%E6%A0%87%E6%B3%A8%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BACOCO%E6%A0%BC%E5%BC%8F/"/>
    <id>https://enoch2090.github.io/2021/01/06/tech/%E6%8A%8AYOLO%E6%A0%87%E6%B3%A8%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BACOCO%E6%A0%BC%E5%BC%8F/</id>
    <published>2021-01-05T16:00:00.000Z</published>
    <updated>2021-01-23T12:43:03.603Z</updated>
    
    <content type="html"><![CDATA[<p>实验室之前用的模型是基于Darknet的YOLO。这两天需要试一些其它模型，所以我准备给标注文件做个格式转换。网上找了半天都找不到个<strong>给人用的</strong>YOLO转COCO脚本，遂自己写了一个。分享一下，大家可能用得上。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原先YOLO标注存放结构：</span></span><br><span class="line"><span class="comment"># - ...</span></span><br><span class="line"><span class="comment">#  |</span></span><br><span class="line"><span class="comment">#  +- FOLDER # 存放所有图片和对应的标注</span></span><br><span class="line"><span class="comment">#  | |</span></span><br><span class="line"><span class="comment">#  | + a.jpg # 图片</span></span><br><span class="line"><span class="comment">#  | |</span></span><br><span class="line"><span class="comment">#  | + a.txt # 图片对应的标注文件</span></span><br><span class="line"><span class="comment">#  |</span></span><br><span class="line"><span class="comment">#  + train.txt # 记录训练/测试/验证的分割文件，里面包含FOLDER下的图片文件名</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 转化后在 FOLDER 同级下添加train.json，存放所有 train.txt 包含的文件名的图片对应的标注。其它不作改动，方便兼容。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os.path <span class="keyword">as</span> osp</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----使用前在此设置----</span></span><br><span class="line">origDir = <span class="string">"../dataset/"</span> <span class="comment"># 即上面的 FOLDER</span></span><br><span class="line">origList = <span class="string">"../dataset/train_split.txt"</span> <span class="comment"># 即上面的 train.txt</span></span><br><span class="line">dumpDir = <span class="string">"../dataset/train.json"</span> <span class="comment"># 即上面的 train.json</span></span><br><span class="line">CLASSES = [] <span class="comment"># 在这里添加所有要用的类</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----工具函数----</span></span><br><span class="line"><span class="keyword">global</span> id</span><br><span class="line">id = <span class="number">0</span></span><br><span class="line"><span class="keyword">global</span> anno_id</span><br><span class="line">annoId = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">incrId</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> id</span><br><span class="line">    id += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> id</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">incrAnnoId</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> annoId</span><br><span class="line">    annoId += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> annoId</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----生成COCO下标注文件的Dict----</span></span><br><span class="line">COCO_OBJ = &#123;&#125;</span><br><span class="line">COCO_OBJ[<span class="string">"categories"</span>] = [</span><br><span class="line">    &#123;<span class="string">"id"</span>: incrId(), <span class="string">"name"</span>: x, <span class="string">"supercategory"</span>: <span class="string">""</span>&#125; <span class="keyword">for</span> x <span class="keyword">in</span> CLASSES]</span><br><span class="line">COCO_OBJ[<span class="string">"images"</span>] = []</span><br><span class="line">COCO_OBJ[<span class="string">"annotations"</span>] = []</span><br><span class="line">id = <span class="number">0</span></span><br><span class="line">annoId = <span class="number">0</span></span><br><span class="line">fileList = []</span><br><span class="line"><span class="keyword">with</span> open(origList, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    fileList = [x.replace(<span class="string">"\n"</span>, <span class="string">""</span>) <span class="keyword">for</span> x <span class="keyword">in</span> f.readlines()] <span class="comment"># 根据 train.txt 的格式标准，你可能需要改动这一行来适应。</span></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> fileList:</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">".jpg"</span> <span class="keyword">in</span> img):</span><br><span class="line">        print(img)</span><br><span class="line">        anno = img.replace(<span class="string">".jpg"</span>, <span class="string">".txt"</span>)</span><br><span class="line">        annoPath = osp.join(origDir, anno)</span><br><span class="line">        imgPath = osp.join(origDir, img)</span><br><span class="line">        imgObj = cv2.imread(imgPath)</span><br><span class="line">        width = imgObj.shape[<span class="number">1</span>]</span><br><span class="line">        height = imgObj.shape[<span class="number">0</span>]</span><br><span class="line">        imgStruct = &#123;                  <span class="comment"># 有需求自行在此添加</span></span><br><span class="line">            <span class="string">"id"</span>: incrId(),</span><br><span class="line">            <span class="string">"width"</span>: width,</span><br><span class="line">            <span class="string">"height"</span>: height,</span><br><span class="line">            <span class="string">"file_name"</span>: img,</span><br><span class="line">            <span class="string">"license"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"flickr_url"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"coco_url"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"date_captured"</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        COCO_OBJ[<span class="string">"images"</span>].append(imgStruct)</span><br><span class="line">        annoLines = []</span><br><span class="line">        <span class="keyword">with</span> open(annoPath, <span class="string">"r"</span>) <span class="keyword">as</span> a:</span><br><span class="line">            annoLines = a.readlines()</span><br><span class="line">        <span class="keyword">for</span> annoLine <span class="keyword">in</span> annoLines:</span><br><span class="line">            annoLine = annoLine.replace(<span class="string">"\n"</span>, <span class="string">""</span>)</span><br><span class="line">            annoComponents = annoLine.split(<span class="string">" "</span>)</span><br><span class="line">            <span class="keyword">if</span> len(annoComponents) &lt; <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            c_x = float(annoComponents[<span class="number">1</span>])*width</span><br><span class="line">            c_y = float(annoComponents[<span class="number">2</span>])*height</span><br><span class="line">            w = float(annoComponents[<span class="number">3</span>])*width</span><br><span class="line">            h = float(annoComponents[<span class="number">4</span>])*height</span><br><span class="line">            annoStruct = &#123;             <span class="comment"># 有需求自行在此添加</span></span><br><span class="line">                <span class="string">"id"</span>: incrAnnoId(),</span><br><span class="line">                <span class="string">"image_id"</span>: id,</span><br><span class="line">                <span class="string">"category_id"</span>: int(annoComponents[<span class="number">0</span>]),</span><br><span class="line">                <span class="string">"segmentation"</span>: [],</span><br><span class="line">                <span class="string">"area"</span>: float(int(w)*int(h)),</span><br><span class="line">                <span class="string">"bbox"</span>: [</span><br><span class="line">                    float(int(c_x - w/<span class="number">2</span>) + <span class="number">1</span>),  <span class="comment"># x</span></span><br><span class="line">                    float(int(c_y - h/<span class="number">2</span>) + <span class="number">1</span>),  <span class="comment"># y</span></span><br><span class="line">                    float(int(w) - <span class="number">1</span>),          <span class="comment"># w</span></span><br><span class="line">                    float(int(h) - <span class="number">1</span>)           <span class="comment"># h</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">            COCO_OBJ[<span class="string">"annotations"</span>].append(annoStruct)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(dumpDir, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(COCO_OBJ, f)</span><br></pre></td></tr></table></figure><p>这里我对坐标转换的处理取了个上下整，尽量保证不溢出图像边缘。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;实验室之前用的模型是基于Darknet的YOLO。这两天需要试一些其它模型，所以我准备给标注文件做个格式转换。网上找了半天都找不到个&lt;strong&gt;给人用的&lt;/strong&gt;YOLO转COCO脚本，遂自己写了一个。分享一下，大家可能用得上。&lt;/p&gt;
&lt;figure clas
      
    
    </summary>
    
    
    
      <category term="Python" scheme="https://enoch2090.github.io/tags/Python/"/>
    
      <category term="目标检测" scheme="https://enoch2090.github.io/tags/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/"/>
    
  </entry>
  
  <entry>
    <title>国王湖落日</title>
    <link href="https://enoch2090.github.io/2021/01/05/culture/%E5%9B%BD%E7%8E%8B%E6%B9%96%E8%90%BD%E6%97%A5/"/>
    <id>https://enoch2090.github.io/2021/01/05/culture/%E5%9B%BD%E7%8E%8B%E6%B9%96%E8%90%BD%E6%97%A5/</id>
    <published>2021-01-04T16:00:00.000Z</published>
    <updated>2021-01-05T16:49:07.670Z</updated>
    
    <content type="html"><![CDATA[<p>那天的游人都自备汽油。<br>一次出乎意料的王车易位，<br>进攻接踵而至。<br>Der Königssee，你最好<br>有千里以外的记忆。有些寒冬<br>人们在冰上滑行，凿出冰窟垂钓<br>青苔。压力如此巨大，<br>陡峭的沙石无法支撑。<br>好了，就此忘掉这段对话。<br>沙滩边的更衣室<br>地面粗粝潮湿，墙上蛛网爬遍。<br>夏天还有多余时间<br>路过请抓紧溺水。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;那天的游人都自备汽油。&lt;br&gt;一次出乎意料的王车易位，&lt;br&gt;进攻接踵而至。&lt;br&gt;Der Königssee，你最好&lt;br&gt;有千里以外的记忆。有些寒冬&lt;br&gt;人们在冰上滑行，凿出冰窟垂钓&lt;br&gt;青苔。压力如此巨大，&lt;br&gt;陡峭的沙石无法支撑。&lt;br&gt;好了，就此忘掉这段对话
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>梦醒时分</title>
    <link href="https://enoch2090.github.io/2021/01/03/culture/%E6%A2%A6%E9%86%92%E6%97%B6%E5%88%86/"/>
    <id>https://enoch2090.github.io/2021/01/03/culture/%E6%A2%A6%E9%86%92%E6%97%B6%E5%88%86/</id>
    <published>2021-01-02T16:00:00.000Z</published>
    <updated>2021-01-02T17:32:35.153Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/01/03/culture/%E6%A2%A6%E9%86%92%E6%97%B6%E5%88%86/DREAMs.jpg" alt="DREAMs" style="zoom:67%;"></p><h2 id="第二种夜晚"><a href="#第二种夜晚" class="headerlink" title="第二种夜晚"></a>第二种夜晚</h2><p>教授总是感叹：我不太理解你们<br>这些人，你们如此执着于描写夜晚。<br>但是对于我们（甚至不在一个时区<br>的情况下）<br>大部分时间的清醒意味着<br>必须在深夜醒来，独自<br>喝上一杯牛奶。黑暗中走回房间，<br>踢到床脚并且弄丢拖鞋。<br>三点以后的思考都是<br>徒劳地衰减，意识退回原始混沌<br>的泥潭，它的二次微分折射出<br>深渊的光线。但凡对这种夜晚有<br>任何执着，那只不过是<br>冰箱里没有牛奶罢了。所以<br>不要说这是熬夜到三点，或者更晚。<br>而要说：我在做持续的抉择，并且<br>我明白这里面的风险。</p><p>这就是第二种夜晚。</p><hr><h2 id="沉"><a href="#沉" class="headerlink" title="沉"></a>沉</h2><p>临下水时，墙角里<br>一只甲虫风声鹤唳。<br>窗外几百米是一条乡间<br>高速公路。月光稀释在<br>路灯的反光里，打碎<br>货车经过的回响。<br>逐渐下沉。黑暗是唯一的<br>潜水服，水底的声速有<br>每秒一千六百米<br>躺在床上空想，<br>终不能获知路况<br>所以潜泳的人<br>都要学习多普勒效应。</p><hr><h2 id="林奇主义者的自传"><a href="#林奇主义者的自传" class="headerlink" title="林奇主义者的自传"></a>林奇主义者的自传</h2><p>床，虚无的<br>意向，上面躺着死人。<br>他曾在夕阳下出发，踏进<br>落雨的屋门。一小片<br>碧绿而皱折的墙纸——<br>那后面传来不少空洞笑声。<br>不知所云，自以为是。这些<br>都归因给生活，灰暗的迷雾里<br>看不清蓝丝绒长裙下的血。<br>猫头鹰不是我们所见到的、听到的<br>或是触碰到的那样。在那栋木结构的<br>房子里游荡，去注意<br>墙角那根煤气管。黑暗里无人告密<br>阴影宣告虚空的胜利。多半是与火<br>同行，人们还在对话。<br>兔子发问<br>婴孩作答<br>观影的人昏昏欲睡<br>读诗的人暗自咒骂</p><hr><h2 id="假阳光"><a href="#假阳光" class="headerlink" title="假阳光"></a>假阳光</h2><p>你，孤独的守夜人，身处<br>斑驳黑暗中。等待<br>某个夏天黄昏，<br>长久坐在窗边。<br>遥远的平面寂静，<br>而角落里一束未名之光，<br>无息地扫过<br>美术馆谨慎的冷气</p><p>那里的窗棂反射着<br>聚光灯的回响。</p><hr><h2 id="星"><a href="#星" class="headerlink" title="星"></a>星</h2><p>窒息着旋转<br>落进记忆棉枕头。<br>他们总是摄入过多咖啡因，夜晚<br>因此消解于永不停歇的鼓点。<br>原本的房间变得久远，<br>人们熟悉这种定式是始于黑暗中<br>明白何处能触及灯开关。<br>咔嗒一声，他们现在清楚地看到绝望<br>是怎样灯火通明<br>步入那种进程，世界也就不再<br>得到解释。房间现在充斥着<br>消弭的内因——<br>一杯耶加雪菲水洗，一张<br>星图。汤姆上校现在开始游荡。<br>待到梦醒那种霍珀式阳光，星空<br>就只剩下远景丛树和谎言的梯形。</p><hr><h2 id="醒"><a href="#醒" class="headerlink" title="醒"></a>醒</h2><p>在梦里做梦，是没有分支的递归。<br>我们常说的栈溢出，也不过是惊厥<br>深埋在丝绒和棉布之间的<br>自愿醒来或被迫沉睡，对象后来<br>新建于堆上面。空间都在午夜释放。<br>但我向来不敢<br>关掉闹钟。否则梦醒时分<br>何处是返回的指针？<br>一块碎裂时间<br>如此划给英灵殿。<br>滚滚雷声在命令行<br>警示世人：确切泄漏了七万六千字节。</p><hr><h2 id="第三种夜晚"><a href="#第三种夜晚" class="headerlink" title="第三种夜晚"></a>第三种夜晚</h2><p>不合时宜的气温。<br>汗水渗透床褥，空调持续单调<br>轰鸣。取一次傅立叶变换，<br>烦躁变作频域几个脉冲。孤独<br>背后一片连绵似海的正弦起伏。<br>清醒是残月下的阿雷西博<br>不眠之人的思维<br>中空且多孔，浮力阻碍生者<br>向死境下沉。滞留，终于注意到<br>水面近似狄拉克函数的波纹。<br>振荡永不会停止。怎样去到<br>那无穷小的瞬间？<br>——惊醒，又复睡去<br>梦里回到时域，水面<br>解析成一幅二维图像。<br>只看一次。现实在<br>交并比四分之三处显现<br>越过阈值，终将醒来。面壁穹顶，无可奈何<br>生命疲于二次回归，这就是第三种夜晚。</p><hr><p>两首新作，一些更新。睡吧孤独的失眠人，do you feel the funeral in your brain？</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2021/01/03/culture/%E6%A2%A6%E9%86%92%E6%97%B6%E5%88%86/DREAMs.jpg&quot; alt=&quot;DREAMs&quot; style=&quot;zoom:67%;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;第二种夜晚&quot;&gt;&lt;a href
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>还就那个修了两整天电脑</title>
    <link href="https://enoch2090.github.io/2020/12/25/tech/%E8%BF%98%E5%B0%B1%E9%82%A3%E4%B8%AA%E4%BF%AE%E4%BA%86%E4%B8%A4%E6%95%B4%E5%A4%A9%E7%94%B5%E8%84%91/"/>
    <id>https://enoch2090.github.io/2020/12/25/tech/%E8%BF%98%E5%B0%B1%E9%82%A3%E4%B8%AA%E4%BF%AE%E4%BA%86%E4%B8%A4%E6%95%B4%E5%A4%A9%E7%94%B5%E8%84%91/</id>
    <published>2020-12-24T16:00:00.000Z</published>
    <updated>2020-12-23T18:01:18.696Z</updated>
    
    <content type="html"><![CDATA[<p>实验室的电脑更新换代了。如果装机的活不是被甩给了我，那这件事情该多完美。因为最近有个项目需要训练不少模型作对比，他们这次直接搞了一块3090，加起来两万块的配置丢给第二次装机的我——我觉着老师也是心大。</p><p>反正我折腾了一下午，算是让它跑起来了，也没有什么地方烧掉。作为生产环境的电脑，肯定是首选Ubuntu而不是Windows。就在系统安装完启动以后，灾难来了。它连不上网。</p><p>第一反应肯定是<code>ifconfig</code>看看情况。试了一下没辙，<code>net-tools</code>根本没装，没网也没法<code>apt-get</code>。那天很晚了，我就走了。隔天回来研究了好久，最后搜索主板型号+Ubuntu 18.04找到了原因：主板型号太新了，Linux内核还没支持到它的网卡驱动，需要自己装。下载好驱动，用U盘拷到机子上，又出事了：没有<code>Make</code>。下好<code>Make</code>的deb包装好，问题又来了：居然找不到<code>gcc</code>。</p><p>找不到<code>gcc</code>不能编译网卡驱动，没有网卡驱动上不了网，上不了网装不上<code>gcc</code>。Bionic Beaver真有你的！我愤怒地把Canary Mail从收藏夹里删除。办法还是有的：Linux系统自带一个旧版本的<code>gcc</code>，在<code>/usr/bin</code>下面。所以用<code>ln -s</code>把这个<code>gcc</code> 链接到<code>/usr/local/bin</code>下面，就能暂时调用<code>gcc</code>了。</p><p>最后我还需要让这台电脑能外网访问并且使用<code>ssh</code>，这样就不用天天往实验室跑了。外网访问需要几件事情：</p><ol><li>机器上启动<code>ssh</code>服务，这个简单。</li><li>给机器设置一个静态ip地址。</li><li>在路由器里设置虚拟服务器（端口映射），或者设置DMZ主机。</li></ol><p>很简单吧？也不算。实验室的网络拓扑比较复杂，我在弄的时候并不知道，我把网线插在了一个子路由的出口上……于是我对着DHCP自动分配的ip地址里的2号网段疑惑了好久，并且在我设置了静态ip以后，不仅外网找不到这台机器了，这台机器也不认识外网了。</p><p>最后是问了学长才明白这后面的结构。这就好办了，子路由器直接把这台机器设置成DMZ主机，主路由器再把子路由器的端口分别作映射。DONE。</p><p>本来我还想寒假装台电脑的，现在看来还是算了。我现在看到硅脂和理线带就想吐。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;实验室的电脑更新换代了。如果装机的活不是被甩给了我，那这件事情该多完美。因为最近有个项目需要训练不少模型作对比，他们这次直接搞了一块3090，加起来两万块的配置丢给第二次装机的我——我觉着老师也是心大。&lt;/p&gt;
&lt;p&gt;反正我折腾了一下午，算是让它跑起来了，也没有什么地方烧掉
      
    
    </summary>
    
    
    
      <category term="Linux" scheme="https://enoch2090.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Chegg日卡也能变成产品……¿</title>
    <link href="https://enoch2090.github.io/2020/12/06/ideas/Chegg%E6%97%A5%E5%8D%A1%E4%B9%9F%E8%83%BD%E5%8F%98%E6%88%90%E4%BA%A7%E5%93%81%E2%80%A6%E2%80%A6%C2%BF/"/>
    <id>https://enoch2090.github.io/2020/12/06/ideas/Chegg%E6%97%A5%E5%8D%A1%E4%B9%9F%E8%83%BD%E5%8F%98%E6%88%90%E4%BA%A7%E5%93%81%E2%80%A6%E2%80%A6%C2%BF/</id>
    <published>2020-12-05T16:00:00.000Z</published>
    <updated>2020-12-06T11:58:44.863Z</updated>
    
    <content type="html"><![CDATA[<p>考试周，我试图用一个周末学完电磁学。为了方便看书上的例题，我准备去搞个Chegg账户。<br>先解释下Chegg是什么。这是一个国外的网站，性质大概等同于本科生级别的小猿搜题，只不过是收费的。Chegg的收费相当贵，要$14.99一个月，而且上面的答案质量也普通，说实话是很不值的。估计正是因为这样，很多人选择和朋友拼车。Chegg官方可能也是意识到这种情况，因此附加了很严格的登陆限制：一旦一个账户同时在两个IP上登陆就会被封号。和室友被坑了一回之后，我们大骂资本家不好好改进自己的题库质量而是选择压榨消费者（其实我们这拼车等于是偷渡的），然后准备再也不用这个垃圾网站了。<br>这回算是实在没有办法，因为网上实在是搜不到Griffths的电动力学第四版答案，只有Chegg上找得到，是好是坏都得将就。付款之前我先去万能的闲鱼上搜了一圈，结果找到了一个叫Chegg日卡的东西。<br>Chegg是月付的，根本就没有日卡这个东西。但是他们的描述里有给出用这个日卡的「查题网站」。我上去看了一眼，马上决定：可以买。<br>这个东西真的很有意思。他们所谓的「日卡」、「次卡」是一串CDK一样的代码。日卡8块钱一张，24小时有效；次卡五毛钱一张，可以查一道题。而那个网站只有一个页面：</p><p><img src="/2020/12/06/ideas/Chegg%E6%97%A5%E5%8D%A1%E4%B9%9F%E8%83%BD%E5%8F%98%E6%88%90%E4%BA%A7%E5%93%81%E2%80%A6%E2%80%A6%C2%BF/chegg.png" alt="chegg"></p><p>其实意思挺明显的了，他们后台有个Chegg账号。你输入CDK，有效的话，他们用那个账号去访问你给出的题目链接，把答案爬下来再返回给你。中间过程不涉及任何异地登录，就是单个账号查了很多次题而已。实现技术也很简单，我感觉Flask+BS4/Selenium完全可以搞定。要是哪天想搞side project，整一个这玩意的国外版，甚至能小赚一笔……<br>——开玩笑的。我个人对于数字产品的态度还是能用正版就用正版。但是务实来讲，我也没必要花15刀就为了看两天答案，这个日卡正好满足了我的需求。不看版权问题，这东西可以勉强称作是个产品。而这种「产品」居然会存在，可以看出其实很多人的需求真的就是偶尔查个实在不会的题，或者考试前复习用用。真的每题都不用Chegg就没法活，那也别学了。<br>但是我倒是希望我付的钱能流到官方的口袋里，只可惜Chegg死板的收费方式让这种日卡产品截了胡。Anyway，记录一下这个奇葩黑产的存在。我觉得Chegg迟早有一天会发现这种东西的存在。这时候有三种可能性：</p><ol><li><p>他们不去管。那就是每年损失一些收入，具体多少我也没法估计。</p></li><li><p>官方推出类似的日卡收费方式。这是最好的情况。</p></li><li><p>通过监控每个账号的搜题情况阻止这种事情。这是最low的办法，而且可以预见到黑产会有新的方案去绕过Chegg的屏蔽算法（我已经想得出好几种了），那以后就是一场旷日持久的大战。</p><p>说实话我感觉他们会用第三种方法。No reason，我觉得他们只在意钱。</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;考试周，我试图用一个周末学完电磁学。为了方便看书上的例题，我准备去搞个Chegg账户。&lt;br&gt;先解释下Chegg是什么。这是一个国外的网站，性质大概等同于本科生级别的小猿搜题，只不过是收费的。Chegg的收费相当贵，要$14.99一个月，而且上面的答案质量也普通，说实话是很
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Zeit</title>
    <link href="https://enoch2090.github.io/2020/11/30/culture/Zeit/"/>
    <id>https://enoch2090.github.io/2020/11/30/culture/Zeit/</id>
    <published>2020-11-29T16:00:00.000Z</published>
    <updated>2020-12-06T11:55:17.771Z</updated>
    
    <content type="html"><![CDATA[<p>夏天的时候拍的一点碎片以及冬天的回忆，我们管这种碎裂的残缺的离散的孤立的片段叫时间。</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">    <iframe src="//player.bilibili.com/player.html?aid=627896098&cid=262167689&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;夏天的时候拍的一点碎片以及冬天的回忆，我们管这种碎裂的残缺的离散的孤立的片段叫时间。&lt;/p&gt;
&lt;div style=&quot;position: relative; width: 100%; height: 0; padding-bottom: 75%;&quot;&gt;
    &lt;iframe
      
    
    </summary>
    
    
    
      <category term="Fragments" scheme="https://enoch2090.github.io/tags/Fragments/"/>
    
  </entry>
  
  <entry>
    <title>All that the cicadas had was one day</title>
    <link href="https://enoch2090.github.io/2020/11/24/culture/All%20that%20the%20cicadas%20had%20was%20one%20day/"/>
    <id>https://enoch2090.github.io/2020/11/24/culture/All%20that%20the%20cicadas%20had%20was%20one%20day/</id>
    <published>2020-11-23T16:00:00.000Z</published>
    <updated>2020-11-24T09:47:27.074Z</updated>
    
    <content type="html"><![CDATA[<p>一首以前写的诗，怀念一下过去的夏天。</p><hr><p>All that the cicadas had was one day, the gap<br>between two monsoons. The El Niño<br>ruins everything. Seventeen years spent<br>in dark and damp, wriggling their<br>way out to the promised land. To them the<br>prime number should meant<br>fewer competitors, hence more to share.<br>But now the branches are drown<br>in moisture. Raindrops falling nearby<br>like meteors, splashing on the leaves and<br>releasing a sound that is ten times<br>greater than the weak chirp. A rival that<br>no cicada would ever expected, and the rival<br>that seems never to be tired. Except for one day,<br>that the rain has shortly stopped, and sunshine<br>leaked from the slit of clouds just like<br>any ordinary summer. But not this, with<br>a pack of clouds stacking in the distant<br>horizon. One knew something is going<br>to happen, but the cicadas did’t.<br>So they shook off the water and started the choir.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;一首以前写的诗，怀念一下过去的夏天。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;All that the cicadas had was one day, the gap&lt;br&gt;between two monsoons. The El Niño&lt;br&gt;ruins everything. Se
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>鲸</title>
    <link href="https://enoch2090.github.io/2020/07/22/culture/%E9%B2%B8/"/>
    <id>https://enoch2090.github.io/2020/07/22/culture/%E9%B2%B8/</id>
    <published>2020-07-21T16:00:00.000Z</published>
    <updated>2020-07-22T02:46:48.536Z</updated>
    
    <content type="html"><![CDATA[<p>韦斯特峡湾的海水，不明白<br>那种五十赫兹的振动。抹香鲸的耳朵是<br>一个低通滤波器，只允许通过二十赫兹的声音。<br>那频段属于匀速碎裂的冰川，<br>永久隔阂的风暴，和水底<br>气泡的低鸣。<br>所有在更高维度的，都不存在于深蓝色之中。<br>如果向更深处观望，在黑暗的包裹下本就<br>无法被看到。因此他是族群的<br>鬼魂，是北冰洋里<br>游荡的孤独。<br>这或许是第五次环绕那个岛了，<br>他唱起自己的歌。</p><p>感谢 <a href="https://m.weibo.cn/u/7481531170" target="_blank" rel="noopener">@UndefinedModule</a> 帮我修改的换行。大家可以去 <a href="https://liuyiqi1999.github.io" target="_blank" rel="noopener">liuyiqi1999.github.io</a> 读更好的诗，虽然这个家伙十有八九已经把自己的博客给忘了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;韦斯特峡湾的海水，不明白&lt;br&gt;那种五十赫兹的振动。抹香鲸的耳朵是&lt;br&gt;一个低通滤波器，只允许通过二十赫兹的声音。&lt;br&gt;那频段属于匀速碎裂的冰川，&lt;br&gt;永久隔阂的风暴，和水底&lt;br&gt;气泡的低鸣。&lt;br&gt;所有在更高维度的，都不存在于深蓝色之中。&lt;br&gt;如果向更深处观望，
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>Arctic Code Vault</title>
    <link href="https://enoch2090.github.io/2020/07/18/culture/Arctic%20Code%20Vault/"/>
    <id>https://enoch2090.github.io/2020/07/18/culture/Arctic%20Code%20Vault/</id>
    <published>2020-07-17T16:00:00.000Z</published>
    <updated>2020-07-18T16:55:05.421Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2020/07/18/culture/Arctic%20Code%20Vault/Arctic%20Code%20Vault.png" alt="Arctic Code Vault"></p><p>My code was sent to the north pole.<br>All the segment faults. Invalid<br>access. And stack overflows.<br>And I was told<br>that one day the vault would be moved<br>to Pluto. An archive for humanity, carved<br>on giant obelisks made of<br>granite. There lies my code, silently rendering<br>compiler error, and consuming extra<br>threads, even it’s a static<br>cast on the monument. Observed by<br>all the stellar travellers carrying different<br>types of editor themes. Please tell them I<br>like Nord the most.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2020/07/18/culture/Arctic%20Code%20Vault/Arctic%20Code%20Vault.png&quot; alt=&quot;Arctic Code Vault&quot;&gt;&lt;/p&gt;
&lt;p&gt;My code was sent to the no
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>最近买的几件东西</title>
    <link href="https://enoch2090.github.io/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/"/>
    <id>https://enoch2090.github.io/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/</id>
    <published>2020-07-01T16:00:00.000Z</published>
    <updated>2020-07-02T10:33:56.831Z</updated>
    
    <content type="html"><![CDATA[<p>几样最近买的小东西。</p><h2 id="1-小米手环-5-NFC-版"><a href="#1-小米手环-5-NFC-版" class="headerlink" title="1. 小米手环 5 NFC 版"></a>1. 小米手环 5 NFC 版</h2><p>6 月中发售的新品。上次戴手环还是高二，那时候戴的是 Weloop 的 Now 2，OLED 点阵屏幕，我印象里只有 17 克。50 米防水、续航很久，戴着很省心。要说有什么缺点，那就是功能不足：严重依赖和手机的连接，并且我日常会使用的功能只有看时间、闹钟、心率和睡眠统计。后来换了 Apple Watch，发现一个问题：戴在手上睡觉的东西，还是得轻便一些好。我那块 AW 是别人送的，钢壳 44mm，实在是没法戴着睡觉；就连打字的时候都得摘下来，否则会刮着桌面。<br>所以小米手环 5 一出来我就买了一条。实际的使用体验比我想得要好不少。首先手环的老几样都不少：轻便、长续航、防水、心率和运动功能、振动闹钟。然后在这个基础上，米环 5 的整体水平是相当高的。这是 Now 2 的屏幕：<br><img src="/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/IMG_0574.JPG" alt="Now 2"><br>这是米环 5 的：<br><img src="/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/IMG_5350.JPG" alt="米环 5"><br>显示效果上，这两年智能手环堪称是完成了一次大进化，从点阵分辨率变成了接近视网膜屏的分辨率；从黑白变成了彩色显示。米环 5 也支持 NFC，我拿到以后就在上面开通了一张交通卡。实际的使用体验比刷手机好，因为它没有 AW 和 iPhone 那些刷卡动画，基本上就是瞬间刷出来，并且会振动一下来提醒你，非常干脆利落。至于模拟门禁，因为要去物业办理，我暂时还没有弄。<br>另外米环 5 也可以使用支付宝。它的使用逻辑是：在支付宝 app 里面开通后，会为手环划分出来一个小账户。你可以手动或定期往里面转一点零钱，刷手环的时候用的就是这笔钱，和主账户独立开来。这个功能我出门的时候也用了几次，在主界面右滑就能调出付款码（需要设置一下），效果很不错。<br>至于小爱同学，也就那样吧。这个功能需要手机上的小米运动在后台运行（我用的是 iPhone），所以还是摆脱不了对手机的依赖——那我为什么不用 Siri 呢。不过偶尔还是有点用处的，例如可以快速设置闹钟和提醒事项，不用专门到 app 里弄了。<br>最后就是，这个产品有很多细节的小功能可以设置。例如你可以手动录入振动模式，给不同的场景选用不同的振动方案。又比如你可以设置手环上各个功能的显示顺序、左右滑动调出的快捷功能等。总结来说，这个东西在功能上差不多有 AW 的六七成了，但只需要十分之一的价格。最重要的是，它是真的省心。</p><h2 id="2-Benks-保护套-三折叠蓝牙键盘"><a href="#2-Benks-保护套-三折叠蓝牙键盘" class="headerlink" title="2. Benks 保护套 +  三折叠蓝牙键盘"></a>2. Benks 保护套 +  三折叠蓝牙键盘</h2><p>前段时间换了 2020 新 iPad Pro，买的时候没有选配新的 Smartkeyboard。因为买 iPad 主要是搭 Pencil 写作业用，而新款的 Smartkey board 不拆下来就没法放平 iPad，这实在是有点蠢。但触控板又确实很帅，还是忍不住想玩。<br>在淘宝上逛了好久，我才找到这个组合。首先是 Benk 的保护套，这个保护套是非全包的，只靠磁力吸在 iPad 背面，因此非常轻薄，也不影响 Pencil 的吸力。保护套本身是三折叠的，可以用作支架。<br>然后是键盘，这个键盘是我在淘宝上翻了好久才找到的。键盘本身是一个蓝牙键盘，可以三折叠收纳。展开以后，最右边有一块触控板，可以蓝牙连接使用。和保护套配合起来是这样的：<br><img src="/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/IMG_5352.JPG" alt="使用状态"></p><p>不用的时候也不需要塞在一块，各自该干嘛干嘛。</p><p><img src="/2020/07/02/ideas/%E6%9C%80%E8%BF%91%E4%B9%B0%E7%9A%84%E5%87%A0%E4%BB%B6%E4%B8%9C%E8%A5%BF/IMG_5353.JPG" alt="闲置状态"></p><p>之所以选择这一套而不是淘宝上随处可见的键盘+触控板套装，主要就是考虑到分体的便携性。淘宝上的同类套装都有下述两类毛病中的至少一种：</p><ol><li>保护套采用全包设计。这种设计很笨重，实在是不便携带。而且不管店家怎么宣称不影响笔的收纳，中间垫了一层东西总归会影响吸力和充电的。</li><li>键盘明明是和保护套分体的，非要设计成收纳在一起的。这个设计特别蠢，因为如果把键盘和 iPad 一起塞在保护套里，那样又厚又沉；如果不把键盘收纳在那里面，那么保护套就会空出一块合不紧。<br>反正翻了一大圈，我的结论是：几百块的价位绝无可能买到完美的替代品，出于成本限制最后做出来的东西不可能轻薄，更不可能做到一体。那索性就分开买吧，因此就有了这个组合。<br>不过说实话，便宜归便宜，这套方案花了 Smartkeyboard 十分之一的价格，但也就做到了 60% 的体验。Smartkeyboard 我在店里也摸过，那个触控板手感确实很好，而且面积也很舒服。至于键盘，手感也和我 MBP 上的差不多。<br>但是这个组合里，那个三折叠键盘是我翻了好多店才找到的，它甚至没有牌子。所以，能用是能用，手感就不要指望了。触控板因为是蓝牙的，不是特别跟手而且不支持三指手势；另外键位为了顾及折叠作了轻微调整，需要适应一下。<br>总结来说只是想要玩玩的话，这一套是绝对可以的。生产力？那还是算了吧。</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;几样最近买的小东西。&lt;/p&gt;
&lt;h2 id=&quot;1-小米手环-5-NFC-版&quot;&gt;&lt;a href=&quot;#1-小米手环-5-NFC-版&quot; class=&quot;headerlink&quot; title=&quot;1. 小米手环 5 NFC 版&quot;&gt;&lt;/a&gt;1. 小米手环 5 NFC 版&lt;/h2&gt;&lt;p&gt;6 
      
    
    </summary>
    
    
    
      <category term="iPad" scheme="https://enoch2090.github.io/tags/iPad/"/>
    
      <category term="手环" scheme="https://enoch2090.github.io/tags/%E6%89%8B%E7%8E%AF/"/>
    
  </entry>
  
  <entry>
    <title>The Alternative Spring</title>
    <link href="https://enoch2090.github.io/2020/06/18/culture/The%20Alternative%20Spring/"/>
    <id>https://enoch2090.github.io/2020/06/18/culture/The%20Alternative%20Spring/</id>
    <published>2020-06-17T16:00:00.000Z</published>
    <updated>2020-06-30T10:05:59.064Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2020/06/18/culture/The%20Alternative%20Spring/IMG_4318.JPG" alt="IMG_4318"></p><p>You should receive the postcards by June<br>when I reached Prague.<br>The old town square looks different<br>after the tension of March.<br>We hold meetings to discuss<br>how to nestle down in the chamber of<br>the astronomical clock. From there you can<br>see the pinnacle of the Cathedral<br>occupied by the petrels; and the bricks<br>on the square, an unrecognizable grid seen<br>from above, run over by burning churns.<br>Four months of conference<br>bores everyone. Especially those who<br>don’t belong to this land.<br>The gannets and cormorants. They want<br>to lead all the beaks and feather, and<br>have all the rooftops and chandeliers.<br>But that’s strongly<br>opposed. They did’t grow up on<br>the bank of Vltava, and slide through<br>the eyot at dusk, the sand of which comes<br>from Dresden. They also held up meetings there<br>and isolated us, in spring. All these large<br>coastal breeds, coming from the north<br>where democratic is achieved among all.<br>Only to have more meetings, and endless<br>motions. Quarrels with the flutter of wings<br>while preaching their advanced<br>methods of hatching. But that doesn’t work<br>for us. We are pigeons with<br>a sense for the diretion. Our breed lived on this<br>land for centuries. We witnessed this city<br>built from cobble, and we shall live our way<br>until it burned to ashes. These intruders must<br>be evicted. At all cost.<br>——So as the swallow read her<br>postcard, and cried.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2020/06/18/culture/The%20Alternative%20Spring/IMG_4318.JPG&quot; alt=&quot;IMG_4318&quot;&gt;&lt;/p&gt;
&lt;p&gt;You should receive the postcards by June&lt;br
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>Calgary at dawn</title>
    <link href="https://enoch2090.github.io/2020/06/08/culture/Calgary%20at%20dawn/"/>
    <id>https://enoch2090.github.io/2020/06/08/culture/Calgary%20at%20dawn/</id>
    <published>2020-06-07T16:00:00.000Z</published>
    <updated>2020-06-08T06:22:02.452Z</updated>
    
    <content type="html"><![CDATA[<p>The city does not care how<br>It’s dawn begin. There are<br>Three ice cones under the eave<br>Two drunk men stagger on the street<br>A lonely car to the end of lane.<br>Some pale light far away<br>Some snow sweepers start to bray<br>And the street lamps extend to the highway<br>gradually quench for<br>The first beam of sunlight across the skyline<br>The second car fined for misalign<br>And the third time that vapor piles up from the chimney of<br>the chophouse where people dine.<br>Calgary is at its wake.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;The city does not care how&lt;br&gt;It’s dawn begin. There are&lt;br&gt;Three ice cones under the eave&lt;br&gt;Two drunk men stagger on the street&lt;br&gt;A lo
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>Silver lining</title>
    <link href="https://enoch2090.github.io/2020/06/06/culture/Silver%20lining/"/>
    <id>https://enoch2090.github.io/2020/06/06/culture/Silver%20lining/</id>
    <published>2020-06-05T16:00:00.000Z</published>
    <updated>2020-06-08T09:00:56.682Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2020/06/06/culture/Silver%20lining/Silver%20lining.JPG" alt="Silver lining">They say every cloud has a silver lining.<br>But not from above. There’s a vast ocean of dust and vapor<br>convolving with fragments of thin air.<br>You must read that things don’t get better here.<br>Only in such perspective can you<br>understand buoyancy, how the clouds become<br>borderless tides. How the sunlight turns into<br>the opposite nights. Then if you look down you’d find<br>there are no lines. Only discontinuity of waves<br>where sailors are granted a peek to Atlantis.<br>After that, to return from the stratosphere<br>is to claim one will never reach the land.<br>Each landing becomes a deeper dive. Now look above<br>Do you still see the silver lining?</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2020/06/06/culture/Silver%20lining/Silver%20lining.JPG&quot; alt=&quot;Silver lining&quot;&gt;They say every cloud has a silver lining.&lt;br&gt;But n
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>Opportunity&#39;s mission</title>
    <link href="https://enoch2090.github.io/2020/05/31/culture/Opportunity&#39;s%20mission/"/>
    <id>https://enoch2090.github.io/2020/05/31/culture/Opportunity&#39;s%20mission/</id>
    <published>2020-05-30T16:00:00.000Z</published>
    <updated>2020-06-08T06:20:47.919Z</updated>
    
    <content type="html"><![CDATA[<p>The rover sees no difference between<br>Mars and Earth. The same vast plain<br>with some pits at the center and ridges lie far.<br>Her internal clock always claim<br>that a sol is no different than a day<br>except forty more minutes of slack.<br>Therefore most of time she rests<br>on the edge of a crater. And soaked<br>in the dim sunlight just like<br>back in Mojave, at dusk. If weather permits a stretch she’ll<br>notify those remote engineers and<br>never use up her cell. Until<br>the day when she looked upon<br>the glowing dome where she came from,<br>it stroke her that Mars is different than<br>Earth. It has two moons. One in clear sight<br>but the other concealed itself behind<br>the approaching sandstorm.<br>Soon she felt drowsy underneath<br>a sudden dune who promises<br>gloomy sleepiness, then tranquil dormancy.<br>Opportunity needs a distant dream<br>after all this place is not Earthly<br>and her cell is now empty.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;The rover sees no difference between&lt;br&gt;Mars and Earth. The same vast plain&lt;br&gt;with some pits at the center and ridges lie far.&lt;br&gt;Her in
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>The Rainy Redemption</title>
    <link href="https://enoch2090.github.io/2020/05/22/culture/The%20Rainy%20Redemption/"/>
    <id>https://enoch2090.github.io/2020/05/22/culture/The%20Rainy%20Redemption/</id>
    <published>2020-05-21T16:00:00.000Z</published>
    <updated>2020-05-28T01:27:22.813Z</updated>
    
    <content type="html"><![CDATA[<p>His prison has no boundary<br>but dilating space.<br>So seamless a cage that<br>even the wardens can’t escape.<br>The prisoner is obligated<br>to comprehend, to calculate<br>but never to understand:<br>wherefore is he trapped<br>in rain?</p><p>Do endure eternity for<br>some while before time<br>turns into dimensionless grain.<br>With which concludes end of duty<br>discrete steps in his mind,<br>a part-time slumbering existence folds<br>the boundary back to its center.</p><p>Then another nano second passed and<br>the wardens all deceased to stars.<br>Nowhereman endued with a nowhereland:<br>The imprisoned supersedes the prison. Now<br>he sees beyond<br>the dim envelope of his cell. Forming a looming<br>intention of increasing<br>entropy taunting at his immortality.<br>Preceding phosphorus lies his premise<br>After aluminum leaves what’s alive<br>——Wherefore was he trapped<br>again? The rain won’t stop<br>but eternity has sure begun.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;His prison has no boundary&lt;br&gt;but dilating space.&lt;br&gt;So seamless a cage that&lt;br&gt;even the wardens can’t escape.&lt;br&gt;The prisoner is obligat
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>Suggestions</title>
    <link href="https://enoch2090.github.io/2020/05/21/culture/Suggestions/"/>
    <id>https://enoch2090.github.io/2020/05/21/culture/Suggestions/</id>
    <published>2020-05-20T16:00:00.000Z</published>
    <updated>2020-05-21T08:39:55.094Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2020/05/21/culture/Suggestions/Their%20ad.jpg" alt="Their ad" style="zoom:50%;"></p><p>In Moment they<br>say: Do not<br>waste your day<br>Some starts to play<br>While some obtain arrange-<br>ments of victious<br>drawing and programming way.<br>But where are my ads?<br>I want to learn Python.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2020/05/21/culture/Suggestions/Their%20ad.jpg&quot; alt=&quot;Their ad&quot; style=&quot;zoom:50%;&quot;&gt;&lt;/p&gt;
&lt;p&gt;In Moment they&lt;br&gt;say: Do not&lt;br&gt;waste
      
    
    </summary>
    
    
    
      <category term="Poems" scheme="https://enoch2090.github.io/tags/Poems/"/>
    
  </entry>
  
  <entry>
    <title>解决 Drafts 无法发送到印象笔记的问题</title>
    <link href="https://enoch2090.github.io/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://enoch2090.github.io/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2020-03-23T16:00:00.000Z</published>
    <updated>2020-03-24T08:07:41.598Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/mockup.jpg" alt>自 Drafts 更新到大版本 5.0 以来，「发送到印象笔记」的动作，各类问题就层出不穷。最早的问题是：由于 API 问题，国内版的印象笔记无法完成授权。后来这一问题似乎被修复了，但在 macOS 上 Drafts 仍然无法发送文本到印象笔记。运行「印象笔记」这一步骤时，我自己使用的 Drafts 18.2.1测试版会报错：</p><p><img src="/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-03-23%20%E4%B8%8B%E5%8D%881.48.28.png" alt="动作不支持"></p><p>而根据朋友的反映，即使使用的不是测试版，仍存在动作运行后文本没有被发送到印象笔记的情况。如果你也遇到此类问题，本文提供一种快速简便的解决方案，让你在macOS 上可以用 Drafts 发送文本到印象笔记。</p><p>首先你要有印象笔记的标准账户，也就是 ￥98  一年的那个订阅。这是这个方法的最大缺陷，因为我们需要标准账户的邮件特性来实现我们的需求。不过，有经常发送笔记到印象笔记这个需求的，想必应该都有标准账户吧。</p><p>让我们打开 Mac 上的印象笔记，找到帮助-帐户设置，或者你也可以直接打开：<a href="https://app.yinxiang.com/Settings.action" target="_blank" rel="noopener">app.yinxiang.com/Settings.action</a>，在页面里找「发送电邮到」，复制那个邮箱地址。</p><p> <img src="/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/%E5%B8%90%E6%88%B7%E8%AE%BE%E7%BD%AE.png" alt="帐户设置页面"></p><p>接下来，在Drafts里面新建一条动作，步骤添加「Mail」，「Recipents」里面「To」填刚才复制的邮箱地址，其它留空。邮件内容按默认设置就好，但最好在正文的外面加上一对双百分号，这样能保证强制使用 Markdown 引擎渲染。「Options」里「Send as HTML」建议勾上（不勾也行），「Send in background」也建议勾上，这样会用Drafts的服务器在后台帮你发送，效果更好。不勾就是你本地自己的邮箱app发送。 新建好的动作如下图：</p><p><img src="/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0%E7%9A%84%E9%97%AE%E9%A2%98/%E5%8A%A8%E4%BD%9C%E8%AE%BE%E7%BD%AE-4983232.png" alt="动作设置"></p><p>保存退出，运行动作就行了。你的笔记会被保存到印象笔记的默认文件夹。这个方法有一个其他方法都没有的优点，在抄送里面填个别的邮箱，你可以简单地一次发送到多个印象笔记账户，甚至可以同步到坚果云/Pocket/Instapaper 等。此外，这个动作也可以在 iOS 上流畅运行，双平台通用。</p><p>对比以前我给出的用 URL-Schemes 的解决方案，这个方案是完全后台运行的，不需要在应用之间跳转，基本上还原了正常的发送体验。</p><p>如果你在使用 Drafts 的时候碰到什么别的问题，你也可以把问题发给我。我不保证一定能解决，但是问问我肯定不亏。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2020/03/24/apps/%E8%A7%A3%E5%86%B3%20Drafts%20%E6%97%A0%E6%B3%95%E5%8F%91%E9%80%81%E5%88%B0%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B
      
    
    </summary>
    
    
    
      <category term="Drafts" scheme="https://enoch2090.github.io/tags/Drafts/"/>
    
  </entry>
  
</feed>
